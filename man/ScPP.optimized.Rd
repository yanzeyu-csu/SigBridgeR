% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/24-scPP_Screen.R
\name{ScPP.optimized}
\alias{ScPP.optimized}
\title{Single-Cell Phenotype Profiling (Optimized)}
\usage{
ScPP.optimized(sc_dataset, geneList, probs = 0.2)
}
\arguments{
\item{sc_dataset}{A Seurat object containing single-cell RNA-seq data.
Must have RNA assay with normalized data.}

\item{geneList}{A named list of length 2 containing gene sets for phenotype
characterization. The list should contain:
\itemize{
\item \code{gene_pos} - Genes associated with positive phenotype
\item \code{gene_neg} - Genes associated with negative phenotype
}}

\item{probs}{Numeric value between 0 and 1 specifying the quantile threshold
for phenotype classification. Default: 0.2 (20th and 80th percentiles).}
}
\value{
A list with three components:
\itemize{
\item \code{metadata} - Data frame containing cell metadata with added columns:
\itemize{
\item \code{scPP_AUC} - AUCell scores for positive gene set
\item \code{scPP_AUCwn} - AUCell scores for negative gene set
\item \code{ScPP} - Phenotype classification: "Phenotype+", "Phenotype-", or "Background"
}
\item \code{Genes_pos} - Character vector of genes significantly upregulated
in Phenotype+ cells compared to Phenotype- cells
\item \code{Genes_neg} - Character vector of genes significantly upregulated
in Phenotype- cells compared to Phenotype+ cells
}
}
\description{
Performs optimized single-cell phenotype profiling using gene set enrichment
analysis and differential expression to identify phenotype-associated cells
and marker genes. This implementation uses AUCell for efficient gene set
scoring and provides comprehensive phenotype characterization.
}
\details{
This function implements an optimized workflow for single-cell phenotype
profiling that combines gene set enrichment analysis with differential
expression to identify and characterize cell phenotypes:
\subsection{Method Overview:}{
\enumerate{
\item \strong{Gene Set Scoring}: Uses AUCell to calculate enrichment scores for
both positive and negative gene sets in each cell
\item \strong{Phenotype Classification}: Identifies phenotype-positive and
phenotype-negative cells based on quantile thresholds of AUC scores
\item \strong{Differential Expression}: Finds marker genes distinguishing the
two phenotype groups using Seurat's FindMarkers
}
}

\subsection{Phenotype Classification Criteria:}{
\itemize{
\item \strong{Phenotype+}: High positive gene set score AND low negative gene set score
\item \strong{Phenotype-}: Low positive gene set score AND high negative gene set score
\item \strong{Background}: All other cells not meeting above criteria
}
}

\subsection{Differential Expression Thresholds:}{
\itemize{
\item Absolute average log2 fold change > 1
\item Adjusted p-value < 0.05
}
}
}
\note{
The function requires the Seurat object to have normalized data in the RNA
assay. For Seurat version compatibility, it handles both v4 and v5 data
structures automatically.
}
\examples{
\dontrun{
# Example using a Seurat object and gene lists
gene_list <- list(
  gene_pos = c("CD4", "IL7R", "CCR7"),
  gene_neg = c("CD8A", "CD8B", "GZMB")
)

result <- ScPP.optimized(
  sc_dataset = seurat_obj,
  geneList = gene_list,
  probs = 0.2
)

# Access results
head(result$metadata)
result$Genes_pos
result$Genes_neg
}

}
\references{
\url{https://github.com/WangX-Lab/ScPP/}, function ScPP()
}
\seealso{
\code{\link[AUCell:AUCell_buildRankings]{AUCell::AUCell_buildRankings()}}, \code{\link[AUCell:AUCell_calcAUC]{AUCell::AUCell_calcAUC()}},
\code{\link[Seurat:FindMarkers]{Seurat::FindMarkers()}}

Other scPP: 
\code{\link{DoscPP}()}
}
\concept{scPP}
\keyword{internal}
