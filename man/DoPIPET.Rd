% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/27-PIPET_Screen.R
\name{DoPIPET}
\alias{DoPIPET}
\title{Perform PIPET Screening Analysis}
\usage{
DoPIPET(
  matched_bulk,
  sc_data,
  phenotype,
  phenotype_class = c("binary", "continuous"),
  group = NULL,
  discretize_method = c("kmeans", "median", "custom"),
  cutoff = NULL,
  label_type = "PIPET",
  log2FC = 1L,
  p_adjust = 0.05,
  show_log2FC = TRUE,
  freq_counts = NULL,
  normalize = TRUE,
  scale = TRUE,
  nPerm = 1000L,
  distance = c("cosine", "pearson", "spearman", "kendall", "euclidean", "maximum"),
  ...
)
}
\arguments{
\item{matched_bulk}{Normalized bulk expression matrix (features Ã— samples).
Column names must match \code{phenotype} identifiers.}

\item{sc_data}{Seurat object containing single-cell RNA-seq data.}

\item{phenotype}{Clinical outcome data. Can be:
- Vector: named with sample IDs
- Data frame: with row names matching bulk columns}

\item{phenotype_class}{Analysis mode:
- \code{"binary"}: Case-control design (e.g., responder/non-responder)
- \code{"continuous"}: Continuous outcome (e.g.,)}

\item{group}{A character, name of one metadata column to group cells by (for example, orig.ident). The default value is \code{NULL}. In this case, screening will be performed on each group separately.}

\item{discretize_method}{\code{c("median", "kmeans", "custom")}. Discretization
strategy for continuous phenotypes. Note: \code{"median"} is mapped internally to
\code{"quantile"} (2-group quantile split). Default: \code{"median"}.}

\item{cutoff}{Numeric vector of length \code{n_group - 1}. Required only when
\code{discretize_method = "custom"}. Defines interior breakpoints on the
\emph{normalized, log2-transformed scale} (i.e., after \code{scale(log2(x + 1))}).
Must be sorted in ascending order.}

\item{label_type}{Character specifying phenotype label type (e.g., "SBS1", "time"), stored in \code{scRNA_data@misc}}

\item{log2FC}{In the DESeq differential expression analysis results, the cutoff value of log2FC. The default value is \code{1L}.}

\item{p_adjust}{In the DESeq differential expression analysis results, the cutoff value of adjust P. The default value is \code{0.05}.}

\item{show_log2FC}{Select whether to show log2 fold changes. The default value is \code{TRUE}.}

\item{freq_counts}{An integer, keep genes expressed in more than a certain number of cells. The default value is \code{NULL}, which means no filtering.}

\item{normalize}{Select whether to perform normalization of count data. The default value is \code{TRUE}.}

\item{scale}{Select whether to scale and center features in the dataset. The default value is \code{TRUE}.}

\item{nPerm}{An integer, number of permutations to do. The default value is \code{1000L}.}

\item{distance}{A character, the distance algorithm must be included in "cosine", "pearson", "spearman", "kendall","euclidean","maximum". default value is \code{NULL}, which means \code{"cosine"}.}

\item{...}{Additional arguments to be passed to \code{PIPET.optimized}.
\itemize{
\item seed: Random seed for reproducibility
\item verbose: Whether to show progress messages
\item parallel: Whether to use parallel processing, default is \code{FALSE}. future::plan() must be set before calling this function.
}}
}
\description{
Predicts cell subpopulations in single-cell data by matching expression profiles
to predefined marker gene templates using various distance/similarity metrics.
This function implements a template-based classification approach with permutation
testing for significance assessment.
}
\seealso{
Other screen_method: 
\code{\link{DoDEGAS}()},
\code{\link{DoLP_SGL}()},
\code{\link{DoScissor}()},
\code{\link{DoscAB}()},
\code{\link{DoscPAS}()},
\code{\link{DoscPP}()}
}
\concept{PIPET}
\concept{screen_method}
