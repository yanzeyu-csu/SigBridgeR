% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/12-AggregateDupGenes.R
\name{AggregateDupGenes}
\alias{AggregateDupGenes}
\title{Aggregate Rows with Duplicate Row Names by Column-wise Summation}
\usage{
AggregateDupGenes(x)
}
\arguments{
\item{x}{A numeric matrix-like object: \code{matrix}, \code{data.frame}, or \code{Matrix}
(S4 class, e.g., \code{dgCMatrix}, \code{dgeMatrix}). Row names must be non-\code{NULL}
and character. Missing values (\code{NA}) are removed during summation (\code{na.rm = TRUE}).}
}
\value{
An object of the same \emph{effective} type as input:
\itemize{
\item If \code{x} is a plain \code{matrix} (not data.frame), returns a \code{matrix}.
\item If \code{x} is a \code{data.frame}, returns a \code{data.frame}.
\item If \code{x} is a \code{Matrix} S4 object, returns a dense \code{matrix} (sparse structure
is not preserved post-aggregation for simplicity and compatibility).
}
Row names are the unique identifiers from \code{rownames(x)}; order follows first occurrence.
}
\description{
This function collapses rows that share identical row names (e.g., duplicated gene symbols)
by summing their values column-wise. Designed for expression matrices or count tables
where duplicated features (e.g., isoforms mapped to same gene) should be merged.

Supports \code{matrix}, \code{data.frame}, and \code{Matrix} S4 objects (e.g., \code{dgCMatrix}),
leveraging \code{Matrix::colSums()} for efficient sparse summation when applicable.
}
\examples{
# Example 1: matrix with duplicated genes
mat <- matrix(c(1,2,3, 4,5,6, 7,8,9), nrow = 3,
              dimnames = list(c("TP53", "TP53", "BRCA1"), c("S1", "S2", "S3")))
AggregateDupGenes(mat)
#>       S1 S2 S3
#> TP53   5  7  9
#> BRCA1  3  6  9

# Example 2: sparse Matrix (dgCMatrix)
library(Matrix)
smat <- Matrix(c(1,0,2, 0,3,0, 4,0,5), nrow = 3, sparse = TRUE,
               dimnames = list(c("ACTB", "GAPDH", "ACTB"), c("C1", "C2", "C3")))
AggregateDupGenes(smat)
#>       C1 C2 C3
#> ACTB   5  0  7
#> GAPDH  0  3  0

# Example 3: data.frame
df <- data.frame(val1 = c(1,1,2), val2 = c(10,20,30),
                 row.names = c("X", "X", "Y"))
AggregateDupGenes(df)
#>   val1 val2
#> X    2   30
#> Y    2   30

}
