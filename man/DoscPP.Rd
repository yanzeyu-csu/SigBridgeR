% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/24-scPP_Screen.R
\name{DoscPP}
\alias{DoscPP}
\title{Perform scPP screening analysis}
\usage{
DoscPP(
  matched_bulk,
  sc_data,
  phenotype,
  label_type = "scPP",
  phenotype_class = c("Binary", "Continuous", "Survival"),
  ref_group = 0,
  Log2FC_cutoff = 0.585,
  estimate_cutoff = 0.2,
  probs = 0.2
)
}
\arguments{
\item{matched_bulk}{Bulk expression data (genes Ã— samples) where:
- Column names must match \code{phenotype} row names}

\item{sc_data}{Seurat object containing preprocessed single-cell data:
- Normalized counts in \code{RNA} assay}

\item{phenotype}{Data frame or tibble or named vector with:
- Rownames matching \code{matched_bulk} columns
- For survival: must contain time and status columns}

\item{label_type}{Character specifying phenotype label type (e.g., "SBS1"), stored in \code{scRNA_data@misc}}

\item{phenotype_class}{Analysis type (case-sensitive):
- \code{"Binary"}: Case-control studies (e.g., tumor/normal)
- \code{"Continuous"}: Quantitative traits (e.g., drug response)
- \code{"Survival"}: Time-to-event data (requires time/status columns)}

\item{ref_group}{Reference group or baseline for \strong{binary} comparisons, e.g. "Normal" for Tumor/Normal studies and 0 for 0/1 case-control studies. (default: 0)}

\item{Log2FC_cutoff}{Minimum log2 fold-change for binary markers (default: 0.585)}

\item{estimate_cutoff}{Effect size threshold for \strong{continuous} traits (default: 0.2)}

\item{probs}{Quantile cutoff for cell classification (default: 0.2)}
}
\value{
A list containing:
\describe{
\item{scRNA_data}{Seurat object with added metadata:
\describe{
\item{ScPP}{"Positive"/"Negative"/"Neutral" classification}
}
}
\item{gene_list}{List of genes used for screening}
\item{AUC}{A data.frame with area under the ROC curve:
\describe{
\item{scPP_AUCup}{AUC for positive}
\item{AUCdown}{AUC for negative}
}
}
}
}
\description{
This function performs scPP screening on single-cell data using matched bulk data and phenotype information.
It supports binary, continuous, and survival phenotype types.
}
\section{Algorithm Steps}{

\enumerate{
\item Data Validation: Checks sample alignment between bulk and phenotype data
\item Marker Selection: Identifies phenotype-associated genes from bulk data
\item Single-cell Screening: Projects bulk markers onto single-cell data
\item Cell Classification: Categorizes cells based on phenotype association
}
}

\section{Reference}{

WangX-Lab/ScPP [Internet]. [cited 2025 Aug 31]. Available from: https://github.com/WangX-Lab/ScPP
}

\examples{
\dontrun{
# Binary phenotype analysis
res <- DoscPP(
  matched_bulk = bulk_data,
  sc_data = seurat_obj,
  phenotype = ms_data,
  label_type = "SBS1",
  phenotype_class = "Binary"
)

# Survival analysis
surv_res <- DoscPP(
  sc_data = seurat_obj,
  matched_bulk = bulk_data,
  phenotype = surv_df,
  label_type = "OS_status",
  phenotype_class = "Survival"
)
}

}
\seealso{
Other screen_method: 
\code{\link{DoDEGAS}()},
\code{\link{DoScissor}()},
\code{\link{DoscAB}()},
\code{\link{DoscPAS}()},
\code{\link{Scissor.v5.optimized}()}

Other scPP: 
\code{\link{ScPP.optimized}()}
}
\concept{scPP}
\concept{screen_method}
\keyword{internal}
