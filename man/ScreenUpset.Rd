% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/31-ScreenUpset.R
\name{ScreenUpset}
\alias{ScreenUpset}
\title{ScreenUpset - Visualize cell type intersections from screened Seurat object}
\usage{
ScreenUpset(
  screened_seurat,
  screen_type = NULL,
  show_plot = FALSE,
  n_intersections = 20,
  x_lab = "Screen Set Intersections",
  y_lab = "Number of Cells",
  title = "Cell Counts Across Screen Set Intersections",
  bar_color = "#4E79A7",
  combmatrix_point_color = "black",
  verbose = getFuncOption("verbose"),
  ...
)
}
\arguments{
\item{screened_seurat}{A Seurat object containing screening results in metadata.
Must contain columns with screening types marked as "Positive".}

\item{screen_type}{Character vector of screening types to analyze.
Default: NULL, indicating that a self-search pattern will be used.}

\item{show_plot}{Whether to show the upset plot. Default: FALSE}

\item{n_intersections}{Number of intersections to display in the plot. Default: 20.}

\item{x_lab}{Label for the x-axis. Default: "Screen Set Intersections".}

\item{y_lab}{Label for the y-axis. Default: "Number of Cells".}

\item{title}{Plot title. Default: "Cell Counts Across Screen Set Intersections".}

\item{bar_color}{Color for the bars in the plot. Default: "#4E79A7".}

\item{combmatrix_point_color}{Color for points in the combination matrix. Default: "black".}

\item{verbose}{Logical, whether to print a message}

\item{...}{Additional arguments passed to \code{ggplot2::theme()} for customizing the plot appearance.}
}
\value{
A list containing two elements:
\itemize{
\item \code{plot}: A ggplot object displaying the UpSet plot
\item \code{stats}: A data frame with intersection statistics including:
\itemize{
\item \code{intersection}: Name of the intersection
\item \code{sets}: List of screening types in the intersection
\item \code{count}: Number of cells positive for all screening types in the intersection
}
}
}
\description{
This function creates an UpSet plot to visualize intersections between different
screening methods (e.g., scissor, scAB, scPAS, scPP) in a Seurat object metadata.
It calculates all possible combinations of screening types and displays the
number of cells positive for each combination.
}
\details{
The function performs the following steps:
\enumerate{
\item Validates input parameters and checks if specified screening types exist in metadata
\item Generates all possible combinations of screening types (from 1 to the total number of types)
\item Creates a logical matrix of positive cells for efficient computation
\item Calculates cell counts for each intersection using vectorized operations
\item Creates an UpSet plot visualization with customizable appearance
}
}
\examples{
\dontrun{
# Basic usage with default parameters
result <- ScreenUpset(screened_seurat = my_seurat_obj)

# Customize screening types and appearance
result <- ScreenUpset(
  screened_seurat = my_seurat_obj,
  screen_type = c("scissor", "scAB"),
  n_intersections = 15,
  title = "Custom Title",
  bar_color = "darkred"
)
}


}
\seealso{
Other visualization_function: 
\code{\link{ScreenFractionPlot}()}
}
\concept{visualization_function}
