% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/30-ScreenFractionPlot.R
\name{ScreenFractionPlot}
\alias{ScreenFractionPlot}
\title{Visualization of Cell Screening Fractions}
\usage{
ScreenFractionPlot(
  screened_seurat,
  group_by = "Source", # x-axis label
  screen_type = NULL, # default: search all available screens
  show_null = FALSE,
  plot_color = NULL, # stack bar color of each status
  show_plot = FALSE,
  plot_title = "Screen Fraction",
  stack_width = 0.85,
  x_text_angle = 45,
  axis_linewidth = 0.8,
  legend_position = "right",
  x_lab = NULL,
  y_lab = "Fraction of Status",
  ncol = 2, # number of columns for facet wrap
  nrow = NULL, # number of rows for facet wrap
  verbose = getFuncOption("verbose"),
  ... # ggplot2 theme arguments
)
}
\arguments{
\item{screened_seurat}{A Seurat object containing screening results in metadata.
Must contain columns corresponding to \code{screen_type}.}

\item{group_by}{Metadata column name for grouping samples (default: "Source").}

\item{screen_type}{Screening algorithm(s) used. Can be a single value or vector.
Must match metadata column(s) (case-sensitive, e.g., "scissor" for Scissor results).}

\item{show_null}{Logical whether to show groups with zero cells (default: FALSE).}

\item{plot_color}{Custom color palette (named vector format):
- Required names: "Positive", "Negative", "Neutral"
- Default: c("Neutral"="#CECECE", "Other"="#CECECE", Positive"="#ff3333", "Negative"="#386c9b")}

\item{show_plot}{Logical to immediately display plot (default: TRUE).}

\item{plot_title}{Plot title (default: "Screen Fraction"). When multiple screen types,
can be a vector of titles or single title (will append screen type).}

\item{stack_width}{Bar width (default: 0.85).}

\item{x_text_angle}{X-axis label angle (default: 45).}

\item{axis_linewidth}{Axis line thickness (default: 0.8).}

\item{legend_position}{Legend position (default: "right").}

\item{x_lab}{X-axis label (default: NULL).}

\item{y_lab}{Y-axis label (default: "Fraction of Status").}

\item{ncol}{Number of columns for facet wrap when multiple screen types (default: 2).}

\item{nrow}{Number of rows for facet wrap when multiple screen types (default: NULL).}

\item{verbose}{Logical, whether to print a message}

\item{...}{Other arguments passed to ggplot2::theme()}
}
\value{
A list containing:
\itemize{
\item{stats: A data frame (single screen) or list of data frames (multiple screens)
with screening statistics including:
\itemize{
\item Grouping variable counts
\item Raw cell counts
\item Percentage fractions
}
}
\item{plot: A ggplot2 object (single screen) or list of ggplot2 objects (multiple screens)}
\item{combined_plot: A combined plot using patchwork (only for multiple screens)}
}
}
\description{
Generates stacked bar plots showing the proportion of cells classified as
Positive/Negative/Neutral by single-cell screening algorithms (Scissor, scPAS,
scPP, or scAB) across different sample groups. Supports both single and multiple
screen types visualization.
}
\section{Visualization Details}{

\itemize{
\item Bars are ordered by descending Positive fraction
\item Y-axis shows percentage (0-100\%)
\item Zero-fraction groups are automatically hidden unless \code{show_null=TRUE}
\item For multiple screen types, plots can be combined using patchwork
}
}

\examples{
\dontrun{
# Single screen type usage
res <- ScreenFractionPlot(
  screened_seurat = scissor_result,
  group_by = "PatientID",
  screen_type = "scissor"
)

# Multiple screen types at once
multi_res <- ScreenFractionPlot(
  screened_seurat = multi_screened_result,
  group_by = "TissueType",
  screen_type = c("scissor", "scPAS", "scPP", "scAB", "DEGAS"),
  ncol = 2
)
}

}
\seealso{
Other visualization_function: 
\code{\link{ScreenUpset}()}
}
\concept{visualization_function}
