% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/82-VarCalculate.R
\name{Check0VarRows}
\alias{Check0VarRows}
\title{Check for Rows with Zero Variance in a Matrix}
\usage{
Check0VarRows(mat, call = rlang::caller_env())
}
\arguments{
\item{mat}{A numeric matrix or a sparse matrix of class \code{dgCMatrix} (from the \code{Matrix} package).
Rows represent features (e.g., genes), and columns represent observations.}

\item{call}{The environment from which the function was called, used for error reporting.
Defaults to rlang::caller_env(). Most users can ignore this parameter.}
}
\value{
Invisibly returns a numeric vector of row variances. If zero-variance rows are found,
the function throws an error with a message listing the problematic row names.
}
\description{
This function checks each row of a matrix (including sparse matrices of class \code{dgCMatrix})
for zero variance. Rows with zero variance or only \code{NA} values are identified, and an error
is thrown listing the names of these rows. This is useful for preprocessing data where
constant rows may cause issues in analyses (e.g., PCA, regression).
}
\details{
For dense matrices, variance is computed using \code{matrixStats::rowVars()} function that
efficiently calculates row variances with proper NA handling. For sparse matrices of
class \code{dgCMatrix}, variance is computed using a mathematical identity that avoids
creating large intermediate matrices. Rows with fewer than 2 non-zero observations
are treated as zero-variance.
}
\examples{
\dontrun{
# Dense matrix example
set.seed(123)
mat_dense <- matrix(rnorm(100), nrow = 10)
rownames(mat_dense) <- paste0("Gene", 1:10)
Check0VarRows(mat_dense) # No error if all rows have variance

# Introduce zero variance
mat_dense[1, ] <- rep(5, 10) # First row is constant
Check0VarRows(mat_dense)     # Throws error listing "Gene1"

# Sparse matrix example
library(Matrix)
mat_sparse <- as(matrix(rpois(100, 0.5), nrow = 10), "dgCMatrix")
rownames(mat_sparse) <- paste0("Gene", 1:10)
Check0VarRows(mat_sparse)
}


}
\seealso{
Other scPP: 
\code{\link{DoscPP}()},
\code{\link{ScPP.optimized}()}
}
\concept{scPP}
\keyword{internal}
