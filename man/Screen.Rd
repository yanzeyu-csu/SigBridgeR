% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/20-QuickScreen.R
\name{Screen}
\alias{Screen}
\title{Single-Cell Data Screening}
\usage{
Screen(
  matched_bulk,
  sc_data,
  phenotype,
  label_type = NULL,
  phenotype_class = c("binary", "survival", "continuous"),
  screen_method = c("Scissor", "scPP", "scPAS", "scAB"),
  ...
)
}
\arguments{
\item{matched_bulk}{Matrix or data frame of preprocessed bulk RNA-seq expression
data (genes x samples). Column names must match names/IDs in \code{phenotype}.}

\item{sc_data}{A Seurat object containing scRNA-seq data to be screened.}

\item{phenotype}{Phenotype data, either:
- Named vector (names match \code{matched_bulk} columns), or
- Data frame with row names matching \code{matched_bulk} columns}

\item{label_type}{Character specifying phenotype label type (e.g., "SBS1", "time")}

\item{phenotype_class}{Type of phenotypic outcome (must be consistent with input data):
- \code{"binary"}: Binary traits (e.g., case/control)
- \code{"continuous"}: Continuous measurements (only for \code{Scissor}, \code{scPAS}, \code{scPP})
- \code{"survival"}: Survival objects}

\item{screen_method}{Screening algorithm to use, there are four options:
- \code{"Scissor"}: see also \code{DoScissor()}
- \code{"scPP"}: see also \code{DoscPP()}
- \code{"scPAS"}: see also \code{DoscPAS()}
- \code{"scAB"}: see also \code{DoscAB()}, no continuous support}

\item{...}{Additional method-specific parameters:
\describe{
\item{Scissor}{\describe{
\item{scissor_alpha}{(numeric) default 0.05}
\item{scissor_cutoff}{(numeric) default 0.2}
\item{path2load_scissor_cache}{(character) default \code{NULL}}
\item{path2save_scissor_inputs}{(character) default \code{"Scissor_inputs.RData"}}
\item{nfold}{(integer) Cross-validation folds for reliability test, default 10}
\item{reliability_test}{(logical) default FALSE}
}}
\item{scPP}{\describe{
\item{ref_group}{(integer) Reference group for binary comparisons, default 1}
\item{Log2FC_cutoff}{(numeric) Minimum log2 fold-change for binary markers, default 0.585}
\item{estimate_cutoff}{(numeric) Effect size threshold for continuous traits, default 0.2}
\item{probs}{(numeric) Quantile cutoff for cell classification, default 0.2}
}}
\item{scPAS}{\describe{
\item{assay}{(character) Assay to use from sc_data, default "RNA"}
\item{imputation}{(logical) Whether to perform imputation, default FALSE}
\item{nfeature}{(integer) Number of features to select, default 3000}
\item{alpha}{(numeric) Significance threshold, default 0.01}
\item{extra_filter}{(logical) Whether to perform extra filtering based on RNA count, default FALSE}
\item{gene_RNAcount_filter}{(numeric) Only used when \code{extra_filter=TRUE}, default 20}
\item{bulk_0_filter_thresh}{(numeric) Only used when \code{extra_filter=TRUE},default 0.25}
}}
\item{scAB}{\describe{
\item{alpha}{(numeric) Coefficient of phenotype regularization ,default 0.005}
\item{alpha_2}{(numeric) Coefficent of cell-cell similarity regularization, default 5e-05}
\item{maxiter}{(integer) NMF optimization iterations, default 2000}
\item{tred}{(integer) Z-score threshold, default 2}
}}
}}
}
\value{
A list containing:
\describe{
\item{scRNA_data}{Filtered Seurat object with phenotype-associated cells}
\item{matched_samples}{Vector of samples used in the analysis}
\item{method_output}{Method-specific output objects}
}
}
\description{
Integrates matched bulk expression data and phenotype information to identify
phenotype-associated cell populations in single-cell RNA-seq data using one of
four computational methods. Ensures consistency between bulk and phenotype data
before analysis.
}
\section{Data Matching Requirements}{

\itemize{
\item \code{matched_bulk} column names and \code{phenotype} names/rownames must be identical
\item Phenotype values must correspond to bulk samples (not directly to single cells)
\item Mismatches will trigger an error before analysis begins
}
}

\section{Method Compatibility}{
\tabular{lll}{
   \strong{Method} \tab \strong{Supported Phenotypes} \tab \strong{Additional Parameters} \cr
   \code{Scissor} \tab All three types \tab \code{alpha}, \code{lambda} \cr
   \code{scPP} \tab All three types \tab \code{embedding_type} \cr
   \code{scPAS} \tab All three types \tab \code{n_components} \cr
   \code{scAB} \tab Binary/Survival \tab \code{bandwidth} \cr
}
}

\seealso{
Associated functions:
\itemize{
\item \code{\link{DoScissor}}
\item \code{\link{DoscPP}}
\item \code{\link{DoscPAS}}
\item \code{\link{DoscAB}}
}
}
