% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/20-QuickScreen.R
\name{Screen}
\alias{Screen}
\title{Single-Cell Data Screening}
\usage{
Screen(
  matched_bulk,
  sc_data,
  phenotype,
  label_type = NULL,
  phenotype_class = c("binary", "survival", "continuous"),
  screen_method = c("Scissor", "scPP", "scPAS", "scAB"),
  ...
)
}
\arguments{
\item{matched_bulk}{Matrix or data frame of preprocessed bulk RNA-seq expression
data (genes x samples). Column names must match names/IDs in \code{phenotype}.}

\item{sc_data}{A Seurat object containing scRNA-seq data to be screened.}

\item{phenotype}{Phenotype data, either:
- Named vector (names match \code{matched_bulk} columns), or
- Data frame with row names matching \code{matched_bulk} columns}

\item{label_type}{Character specifying phenotype label type (e.g., "SBS1", "time")}

\item{phenotype_class}{Type of phenotypic outcome (must be consistent with input data):
- \code{"binary"}: Binary traits (e.g., case/control)
- \code{"continuous"}: Continuous measurements (only for \code{Scissor}, \code{scPAS}, \code{scPP})
- \code{"survival"}: Survival objects}

\item{screen_method}{Screening algorithm to use, there are four options:
- \code{"Scissor"}: see also \code{DoScissor()}
- \code{"scPP"}: see also \code{DoscPP()}
- \code{"scPAS"}: see also \code{DoscPAS()}
- \code{"scAB"}: see also \code{DoscAB()}, no continuous support}

\item{...}{Additional method-specific parameters:
\describe{
\item{Scissor}{\describe{
\item{alpha}{(numeric or NULL) Significance threshold. When NULL, alpha will keep increasing iteratively until the corresponding cells are screened out, default 0.05}
\item{cutoff}{(numeric) A threshold for terminating the iteration of alpha, only work when \code{alpha} is NULL, default 0.2}
\item{path2load_scissor_cache}{(character) default \code{NULL}}
\item{path2save_scissor_inputs}{(character) A path to save the intermediary data. By using \code{path2load_scissor_cache},  the intermediary data can be loaded from the specified path. default \code{"Scissor_inputs.RData"}}
\item{nfold}{(integer) Cross-validation folds for reliability test, default 10}
\item{reliability_test}{(logical) Whether to perform reliability test, default FALSE}
}}
\item{scPP}{\describe{
\item{ref_group}{(integer or character) Reference group or baseline for \strong{binary} comparisons, e.g. "Normal" for Tumor/Normal studies and 0 for 0/1 case-control studies. default: 0}
\item{Log2FC_cutoff}{(numeric) Minimum log2 fold-change for binary markers, default 0.585}
\item{estimate_cutoff}{(numeric) Effect size threshold for \strong{continuous} traits, default 0.2}
\item{probs}{(numeric) Quantile cutoff for cell classification, default 0.2}
}}
\item{scPAS}{\describe{
\item{assay}{(character) Assay to use from sc_data, default "RNA"}
\item{imputation}{(logical) Whether to perform imputation, default FALSE}
\item{nfeature}{(integer) Number of features to select, default 3000}
\item{alpha}{(numeric or NULL) Significance threshold, When NULL, alpha will keep increasing iteratively until the corresponding cells are screened out, default 0.01}
\item{independent}{(logical) The background distribution of risk scores is constructed independently of each cell. default: TRUE}
\item{network_class}{(character) Network class to use. default: 'SC', indicating gene-gene similarity networks derived from single-cell data. The other one is 'bulk'.}
\item{permutation_times}{(integer) Number of permutations, default 2000}
\item{FDR_threshold}{(numeric) FDR value threshold for identifying phenotype-associated cells default 0.05}
}}
\item{scAB}{\describe{
\item{alpha}{(numeric) Coefficient of phenotype regularization ,default 0.005}
\item{alpha_2}{(numeric) Coefficent of cell-cell similarity regularization, default 5e-05}
\item{maxiter}{(integer) NMF optimization iterations, default 2000}
\item{tred}{(integer) Z-score threshold, default 2}
}}
}}
}
\value{
A list containing:
\describe{
\item{scRNA_data}{Filtered Seurat object with phenotype-associated cells}
\item{Some screen_result}{Important information about the screened result related to the selected method}
}
}
\description{
Integrates matched bulk expression data and phenotype information to identify
phenotype-associated cell populations in single-cell RNA-seq data using one of
four computational methods. Ensures consistency between bulk and phenotype data
before analysis.
}
\section{Data Matching Requirements}{

\itemize{
\item \code{matched_bulk} column names and \code{phenotype} names/rownames must be identical
\item Phenotype values must correspond to bulk samples (not directly to single cells)
\item Mismatches will trigger an error before analysis begins, and there is a built-in pre-run check.
}
}

\section{Method Compatibility}{
\tabular{lll}{
   \strong{Method} \tab \strong{Supported Phenotypes} \tab \strong{Additional Parameters} \cr
   \code{Scissor} \tab All three types \tab \code{alpha}, \code{cutoff}, \code{path2load_scissor_cache}, \code{path2save_scissor_inputs}, \code{nfold}, \code{reliability_test}, \code{reliability_test_n} \cr
   \code{scPP} \tab All three types \tab \code{ref_group}, \code{Log2FC_cutoff}, \code{estimate_cutoff}, \code{probs} \cr
   \code{scPAS} \tab All three types \tab \code{n_components} ,\code{assay}, \code{imputation},\code{nfeature}, \code{alpha},\code{network_class},\code{permutation_times},\code{FDR_threshold},\code{independent} \cr
   \code{scAB} \tab Binary/Survival \tab \code{alpha}, \code{alpha_2}, \code{maxiter}, \code{tred} \cr
}
}

\seealso{
Associated functions:
\itemize{
\item \code{\link{DoScissor}}
\item \code{\link{DoscPP}}
\item \code{\link{DoscPAS}}
\item \code{\link{DoscAB}}
}
}
