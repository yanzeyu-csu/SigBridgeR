% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/21-ScissorScreen.R
\name{DoScissor}
\alias{DoScissor}
\title{Perform Scissor Screening Analysis}
\usage{
DoScissor(
   path2load_scissor_cache = NULL,
   path2save_scissor_inputs = "Scissor_inputs.RData",
   matched_bulk,
   sc_data,
   phenotype,
   label_type = "scissor",
   alpha = c(0.05, NULL),
   cutoff = 0.2,
   scissor_family = c("gaussian", "binomial", "cox"),
   reliability_test = list(
     run = FALSE, # whether to run reliability test
     n = 10L, # permutation times
     nfold = 10L # cross validation folds
   ),
   cell_evaluation = list(
     run = FALSE, # whether to run cell evaluation
     benchmark_data = "path_to_file.RData", # path to benchmark data
     FDR_cutoff = 0.05,
     bootstrap_n = 100L
   ),
   ...
)
}
\arguments{
\item{path2load_scissor_cache}{Path to precomputed Scissor inputs (RData file).
If provided, skips recomputation (default: NULL).}

\item{path2save_scissor_inputs}{Path to save intermediate files (default: "Scissor_inputs.RData").}

\item{matched_bulk}{Normalized bulk expression matrix (features × samples).
Column names must match \code{phenotype} identifiers.}

\item{sc_data}{Seurat object containing single-cell RNA-seq data.}

\item{phenotype}{Clinical outcome data. Can be:
- Vector: named with sample IDs
- Data frame: with row names matching bulk columns}

\item{label_type}{Character specifying phenotype label type (e.g., "SBS1", "time"), stored in \code{scRNA_data@misc}}

\item{alpha}{Parameter used to balance the effect of the l1 norm and the network-based penalties. It can be a number or a searching vector. If alpha = NULL, a default searching vector is used. The range of alpha is between 0 and 1. A larger alpha lays more emphasis on the l1 norm.}

\item{cutoff}{(default: \code{0.2}). When \code{alpha=NULL}, the cutoff is used to determine the optimal alpha.
Higher values increase specificity.}

\item{scissor_family}{Model family for outcome type:
- "gaussian": Continuous outcomes
- "binomial": Binary outcomes (default)
- "cox": Survival outcomes}

\item{reliability_test}{List controlling reliability testing:
\itemize{
\item run: Whether to perform reliability test (default: FALSE)
\item n: Permutation times (default: \code{10L})
\item nfold: Cross-validation folds (default: \code{10L})
}}

\item{cell_evaluation}{List controlling cell evaluation:
\itemize{
\item run: Whether to perform cell evaluation (default: FALSE)
\item benchmark_data: Path to benchmark data (RData file)
\item FDR_cutoff: FDR threshold for evaluation (default: \code{0.05})
\item bootstrap_n: Bootstrap iterations (default: \code{100L})
}}

\item{...}{Additional arguments. Currently supports:
\itemize{
\item \code{verbose}: Logical indicating whether to print progress messages. Defaults to \code{TRUE}.
\item \code{seed}: For reproducibility, default is \code{123L}
}}
}
\value{
A list containing:
\describe{
\item{scRNA_data}{A Seurat object with screened cells containing metadata:
\describe{
\item{scissor}{"Positive"/"Negative"/"Neutral" classification}
\item{label_type}{Outcome label used}
}
}
\item{scissor_result}{Raw Scissor results}
\item{reliability_result}{If reliability_test=TRUE, contains:
\describe{
\item{statistic}{A value between 0 and 1}
\item{p}{p-value of the test statistic}
\item{AUC_test_real}{10 values of AUC for real data}
\item{AUC_test_back}{A list of AUC for background data}
}
}
\item{cell_evaluation}{If cell_evaluation=TRUE, contains:
\describe{
\item{evaluation_res}{A data.frame with some supporting information for each Scissor selected cell}
}
}
}
}
\description{
Identifies phenotype-associated cell subpopulations in single-cell data using
regularized regression on matched bulk expression profiles. Scissor integrates
bulk and single-cell RNA-seq data to identify cells that are significantly
associated with phenotypic outcomes.
}
\section{LICENSE}{

Licensed under the GNU General Public License version 3 (GPL-3.0).
A copy of the license is available at \url{https://www.gnu.org/licenses/gpl-3.0.en.html}.
}

\examples{
\dontrun{
# Binary outcome example
res <- DoScissor(
  matched_bulk = bulk_matrix,
  sc_data = seurat_obj,
  phenotype = a_named_vector,
  scissor_family = "binomial"
)
}

}
\references{
Sun D, Guan X, Moran AE, Wu LY, Qian DZ, Schedin P, et al. Identifying phenotype-associated subpopulations by integrating bulk and single-cell sequencing data. Nat Biotechnol. 2022 Apr;40(4):527–38.
}
\seealso{
Other screen_method: 
\code{\link{DoDEGAS}()},
\code{\link{DoLP_SGL}()},
\code{\link{DoPIPET}()},
\code{\link{DoscAB}()},
\code{\link{DoscPAS}()},
\code{\link{DoscPP}()}

Other scissor: 
\code{\link{DoScissorCellEval}()},
\code{\link{DoScissorRelTest}()}
}
\concept{scissor}
\concept{screen_method}
