% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/21-ScissorScreen.R
\name{DoScissor}
\alias{DoScissor}
\title{Perform Scissor Screening Analysis}
\usage{
DoScissor(
   path2load_scissor_cache = NULL,
   matched_bulk,
   sc_data,
   phenotype,
   label_type = "scissor",
   scissor_alpha = 0.05,
   scissor_cutoff = 0.2,
   scissor_family = c("gaussian", "binomial", "cox"),
   reliability_test = TRUE,
   path2save_scissor_inputs = "Scissor_inputs.RData",
   reliability_test_n = 10,
   nfold = 10,
   ...
)
}
\arguments{
\item{path2load_scissor_cache}{Path to precomputed Scissor inputs (RData file).
If provided, skips recomputation (default: NULL).}

\item{matched_bulk}{Normalized bulk expression matrix (features Ã— samples).
Column names must match \code{phenotype} identifiers.}

\item{sc_data}{Seurat object containing single-cell RNA-seq data.}

\item{phenotype}{Clinical outcome data. Can be:
- Vector: named with sample IDs
- Data frame: with row names matching bulk columns}

\item{label_type}{Character specifying phenotype label type (e.g., "SBS1", "time"), stored in \code{scRNA_data@misc}}

\item{scissor_alpha}{Parameter used to balance the effect of the l1 norm and the network-based penalties. It can be a number or a searching vector. If alpha = NULL, a default searching vector is used. The range of alpha is between 0 and 1. A larger alpha lays more emphasis on the l1 norm.(default: 0.05).}

\item{scissor_cutoff}{(default: 0.2).
Higher values increase specificity.}

\item{scissor_family}{Model family for outcome type:
- "gaussian": Continuous outcomes
- "binomial": Binary outcomes (default)
- "cox": Survival outcomes}

\item{reliability_test}{Logical to perform stability assessment when \code{scissor_alpha} is specified as a value between 0 and 1.(default: TRUE).}

\item{path2save_scissor_inputs}{Path to save intermediate files (default: "Scissor_inputs.RData").}

\item{reliability_test_n}{Number of CV folds for reliability test (default: 10).}

\item{nfold}{Cross-validation folds for reliability test (default: 10).}

\item{...}{Additional arguments passed to \code{Scissor.v5.optimized}.}
}
\value{
A list containing:
\describe{
\item{scRNA_data}{A Seurat object with screened cells containing metadata:
\describe{
\item{scissor}{"Positive"/"Negative"/"Neutral" classification}
\item{label_type}{Outcome label used}
}
}
\item{scissor_result}{Raw Scissor results}
\item{reliability_result}{If reliability_test=TRUE, contains:
\describe{
\item{statistic}{A value between 0 and 1}
\item{p}{p-value of the test statistic}
\item{AUC_test_real}{10 values of AUC for real data}
\item{AUC_test_back}{A list of AUC for background data}
}
}
}
}
\description{
Identifies phenotype-associated cell subpopulations in single-cell data using
regularized regression on matched bulk expression profiles.
}
\section{Reference}{

Sun S et al. (2022). "Scissor identifies phenotype-associated cell subsets
in single-cell genomics." Nat Methods 19(5):600-608. \doi{10.1038/s41592-022-01452-1}
}

\examples{
\dontrun{
# Binary outcome example
res <- DoScissor(
  matched_bulk = bulk_matrix,
  sc_data = seurat_obj,
  phenotype = a_named_vector,
  scissor_family = "binomial"
)
}

}
\keyword{SigBridgeR_internal}
