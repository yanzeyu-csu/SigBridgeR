% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/11-BulkPreProcess.R
\name{BulkPreProcess}
\alias{BulkPreProcess}
\title{Bulk RNA-seq Data Preprocessing and Quality Control Function}
\usage{
BulkPreProcess(
  data,
  sample_info = NULL,
  gene_symbol_conversion = FALSE,
  check = TRUE,
  min_count_threshold = 10L,
  min_gene_expressed = 3L,
  min_total_reads = 1000000L,
  min_genes_detected = 10000L,
  min_correlation = 0.8,
  n_top_genes = 500L,
  show_plot_results = TRUE,
  ...
)
}
\arguments{
\item{data}{Expression matrix with genes as rows and samples as columns, or a list containing count_matrix and sample_info}

\item{sample_info}{Sample information data frame (optional), ignored if data is a list. A qualified \code{sample_info} should contain both \code{sample} and \code{condition} columns (case-sensitive), and there are no specific requirements for the data type stored in the \code{condition} column.}

\item{gene_symbol_conversion}{Whether to convert Ensembles version IDs and TCGA version IDs to genes with IDConverter, default: FALSE}

\item{check}{Whether to perform detailed quality checks, default: TRUE}

\item{min_count_threshold}{Minimum count threshold for gene filtering, default: 10}

\item{min_gene_expressed}{Minimum number of samples a gene must be expressed in, default: 3}

\item{min_total_reads}{Minimum total reads per sample, default: 1e6}

\item{min_genes_detected}{Minimum number of genes detected per sample, default: 10000}

\item{min_correlation}{Minimum correlation threshold between samples, default: 0.8}

\item{n_top_genes}{Number of top variable genes for PCA analysis, default: 500}

\item{show_plot_results}{Whether to generate visualization plots, default: TRUE}

\item{...}{Additional arguments. Currently supports:
\itemize{
\item \code{verbose}: Logical indicating whether to print progress messages. Defaults to \code{TRUE}.
\item \code{seed}: For reproducibility, default is \code{123L}
}}
}
\value{
Filtered count matrix
}
\description{
This function performs comprehensive preprocessing and quality control analysis
for bulk RNA-seq data, including data validation, filtering, batch effect detection,
principal component analysis, and visualization.
}
\details{
The function performs the following operations:
\enumerate{
\item Data validation and format conversion
\item Basic statistics calculation (missing values, read depth, gene detection)
\item Optional detailed quality checks including:
\itemize{
\item Sample correlation analysis
\item Principal Component Analysis (PCA)
\item Outlier detection using Mahalanobis distance
\item Batch effect detection using ANOVA
}
\item Data filtering based on count thresholds and quality metrics
\item Optional gene symbol conversion
\item Visualization generation (PCA plots)
}
}
\section{Quality Metrics}{

The function calculates and reports several quality metrics:
\describe{
\item{Data Integrity}{Number of missing values}
\item{Gene Count}{Total number of genes after filtering}
\item{Sample Read Depth}{Total reads per sample}
\item{Gene Detection Rate}{Number of genes detected per sample}
\item{Sample Correlation}{Pearson correlation between samples}
\item{PCA Variance}{Variance explained by first two principal components}
\item{Batch Effects}{Proportion of genes significantly affected by batch}
}
}

\section{Sample Information Format}{

The sample_info data frame should contain:
\describe{
\item{sample}{Character vector of unique sample identifiers}
\item{condition}{Character vector of experimental conditions}
\item{batch}{Optional character vector of batch identifiers}
}
}

\section{Filtering Criteria}{

Genes are retained if:
\itemize{
\item They have counts >= min_count_threshold in >= min_gene_expressed samples
}

Samples are retained if:
\itemize{
\item Total reads >= min_total_reads
\item Detected genes >= min_genes_detected
\item Mean correlation >= min_correlation (if check=TRUE)
}
}

\seealso{
\code{\link[edgeR]{cpm}} for counts per million calculation,
\code{\link[stats]{prcomp}} for PCA analysis,
\code{\link[stats]{cor}} for correlation analysis,
\code{\link[SigBridgeR]{SymbolConvert}} for gene symbol conversion
}
